<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>Generator BOT ANTAM Bookmarklet</title>

    <style>
      :root {
        --bg: #0a0a0a;
        --card: #121212;
        --input: #1c1c1c;
        --border: #2a2a2a;
        --primary: #00f7a7;
        --primary-dark: #00d68d;
        --text: #e9e9e9;
        --subtext: #b0b0b0;
      }

      body {
        background: var(--bg);
        font-family: "Inter", Arial, sans-serif;
        color: var(--text);
        padding: 25px;
        max-width: 760px;
        margin: auto;
        line-height: 1.6;
      }

      h1 {
        text-align: center;
        font-size: 26px;
        font-weight: 700;
        margin-bottom: 25px;
        background: linear-gradient(90deg, #00f7a7, #00d0ff);
        -webkit-background-clip: text;
        color: transparent;
      }

      .box {
        background: var(--card);
        padding: 22px;
        border-radius: 14px;
        margin-top: 20px;
        border: 1px solid var(--border);
        box-shadow: 0 0 14px rgba(0, 255, 160, 0.08);
      }

      label {
        display: block;
        margin-bottom: 6px;
        color: var(--subtext);
        font-size: 14px;
      }

      input {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid var(--border);
        background: var(--input);
        color: var(--text);
        margin-bottom: 15px;
        outline: none;
        transition: 0.2s;
        font-size: 15px;
      }

      input:focus {
        border-color: var(--primary);
        box-shadow: 0 0 6px rgba(0, 255, 140, 0.4);
      }

      textarea {
        width: 100%;
        height: 300px;
        padding: 14px;
        background: #0d0d0d;
        border: 1px solid var(--border);
        color: var(--primary);
        font-family: monospace;
        border-radius: 10px;
        font-size: 14px;
        resize: vertical;
        box-shadow: inset 0 0 10px rgba(0, 255, 140, 0.07);
      }

      .bookmark-box {
        background: #101010;
        padding: 15px;
        border-radius: 12px;
        margin-top: 12px;
        border: 1px solid var(--border);
        text-align: center;
      }

      .bookmark-link {
        background: var(--primary);
        padding: 12px 22px;
        color: #000;
        font-weight: 700;
        border-radius: 10px;
        display: inline-block;
        text-decoration: none;
        font-size: 15px;
        transition: 0.2s;
      }

      .bookmark-link:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
      }
    </style>
  </head>

  <body>
    <h1>‚ö° Generator BOT ANTAM</h1>

    <div class="box">
      <h3 style="margin-top: 0; margin-bottom: 15px">
        ‚è± Waktu Mulai Klik Otomatis
      </h3>

      <label>Jam</label>
      <input id="jam" type="number" placeholder="Contoh: 8" />

      <label>Menit</label>
      <input id="menit" type="number" placeholder="Contoh: 0" />

      <label>Detik</label>
      <input id="detik" type="number" placeholder="Contoh: 0" />
    </div>

    <div class="box">
      <h3 style="margin-top: 0; margin-bottom: 15px">
        üî• SCRIPT BOT UNIVERSAL (Bookmarklet)
      </h3>

      <div class="bookmark-box">
        <a id="bookmarkBtn" class="bookmark-link" href="#">
          BOT ANTREAN ANTAM
        </a>
        <p>Drag tombol ini ke Bookmark</p>
      </div>

      <textarea id="output" readonly></textarea>
    </div>

    <script>
      function generateBookmarklet() {
        let H = document.getElementById("jam").value || 0;
        let M = document.getElementById("menit").value || 0;
        let S = document.getElementById("detik").value || 0;

        let code = `(function () {

/* =============================
   PERSIST BOT STATE (IMPORTANT)
============================= */
if (!localStorage.getItem("antamBotState")) {
    localStorage.setItem("antamBotState", "off");
}

if (localStorage.getItem("antamBotState") === "on") {
    console.log("%c BOT ACTIVE (RESTORED AFTER REFRESH)",
        "background:#00f7a7;color:#000;padding:4px;font-weight:bold;");
} else {
    console.log("%c BOT STARTED", 
        "background:#00f7a7;color:#000;padding:4px;font-weight:bold;");
    localStorage.setItem("antamBotState", "on");
}

/* =============================
   LOAD TARGET TIME (from bookmarklet)
============================= */
localStorage.setItem("antamTargetH", ${H});
localStorage.setItem("antamTargetM", ${M});
localStorage.setItem("antamTargetS", ${S});

const TARGET_H = parseInt(localStorage.getItem("antamTargetH"));
const TARGET_M = parseInt(localStorage.getItem("antamTargetM"));
const TARGET_S = parseInt(localStorage.getItem("antamTargetS"));

const CLICK_INTERVAL = 50;

/* =============================
   STOP REFRESH AT 06:59
============================= */
const REFRESH_STOP_H = 6;
const REFRESH_STOP_M = 59;

/* =============================
   GET ANTAM CLOCK
============================= */
function getAntamTime() {
    let t = document.querySelector("#clock");
    if (!t) return null;
    let [h, m, s] = t.textContent.trim().split(":").map(n => parseInt(n));
    return { h, m, s };
}

/* =============================
   FIND BUTTON
============================= */
function findButton() {
    return (
        document.querySelector("button.btn-warning") ||
        document.querySelector("button[type='submit']") ||
        [...document.querySelectorAll("button")].find(
            b => b.innerText.includes("Antrean") || b.innerText.includes("Ambil")
        )
    );
}

/* =============================
   AUTO REFRESH (DOES NOT STOP BOT)
============================= */
function autoRefresh(t) {
    if (t.h === REFRESH_STOP_H && t.m === REFRESH_STOP_M) {
        console.log("%c AUTO REFRESH STOPPED ‚Äî 06:59 TERCAPAI",
            "background:#ffcc00;color:#000;padding:4px;font-weight:bold;");
        return;
    }

    console.log("%c REFRESHING...", "background:#333;color:#0f0;padding:4px");
    location.reload(); // bot state tetap ON di localStorage
}

/* =============================
   BOT LOOP
============================= */
window.antamBotInterval = setInterval(() => {
    if (localStorage.getItem("antamBotState") !== "on") return;

    let t = getAntamTime();
    if (!t) return;

    let { h, m, s } = t;

    // Belum waktunya klik => refresh
    if (
        h < TARGET_H ||
        (h === TARGET_H && m < TARGET_M) ||
        (h === TARGET_H && m === TARGET_M && s < TARGET_S)
    ) {
        autoRefresh(t);
        return;
    }

    let btn = findButton();
    if (!btn || btn.disabled) {
        autoRefresh(t);
        return;
    }

    // KLIK
    console.log("%c KLIK!! ‚è± " + h + ":" + m + ":" + s,
        "background:#00ff99;color:#000;padding:4px;font-weight:bold;");
    
    btn.click();

    // Bot selesai setelah klik
    localStorage.setItem("antamBotState", "off");
    clearInterval(window.antamBotInterval);

}, CLICK_INTERVAL);

/* =============================
   TOGGLE (Klik ulang bookmarklet = OFF)
============================= */
if (window._antamToggle) {
    localStorage.setItem("antamBotState", "off");
    console.log("%c BOT STOPPED MANUALLY",
        "background:#ff4444;color:#fff;padding:4px;font-weight:bold;");
}
window._antamToggle = true;

})();

`;
        let bookmarklet = "javascript:" + encodeURIComponent(code);

        document.getElementById("bookmarkBtn").href = bookmarklet;
        document.getElementById("output").value = code;
      }

      setInterval(generateBookmarklet, 300);
    </script>
  </body>
</html>
